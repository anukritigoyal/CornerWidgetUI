/************************************************
 *  Lucep's CornerWidgetUI - An extension to the 
 *  Lucep service that provides an inbound lead form
 *  for websites (free for commercial or non-commercial use)
 *  https://github.com/lucep/CornerWidgetUI
 * 
 *  Copyright (C) 2015 Lucep Pte Ltd 
 *  Contributors: 
 *    - Kaiesh Vohra (@kaiesh - https://github.com/kaiesh)
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 *************************************************/
CornerWidgetUI={},CornerWidgetUI.constants={SESSION_WINDOW:9e5,_uivar_widgetID:"gorillaWidget",_uivar_barID:"gorillaBar",_uivar_barTxtID:"gorillaBarTxt",_uivar_boxID:"gorillaBox",_uivar_pulseID:"gorillaPulse",_uivar_formdataID:"gorillaForm",_uivar_botholder:"gorillaBT",_uivar_kill:"gorillaEnd",_uivar_xboxID:"gorillaX",_uivar_leadnameID:"gorillaFormName",_uivar_leadtelID:"gorillaFormTel",_uivar_leadserviceID:"gorillaFormService",_uivar_sendleadID:"gorillaFormContact",_uivar_formlabelID:"gorillaLabel",_uivar_controlfield1:"gorillaCtrl1",_uivar_controlfield2:"gorillaCtrl2",_formval_placeholder2:"gorillaControlVal"},CornerWidgetUI.menu_tree=function(e,t){for(var r="",n=0;n<e.length;n++)r+="[object Array]"===Object.prototype.toString.call(e[n].children)&&e[n].children.length>0?CornerWidgetUI.menu_tree(e[n].children,t):"<option value='"+e[n].service_id+"'>"+e[n].lt[t]+"</option>";return r},CornerWidgetUI._dyn_obj=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].key]=e[r].value;return t},CornerWidgetUI.init=function(e){$lucep.get_kiosk_details({callback:function(t){t.menu&&t.menu.config?w_conf=t.menu.config:w_conf={},CornerWidgetUI._ui_config=t,CornerWidgetUI._ui_config.default_lang=w_conf.default_lang?w_conf.default_lang:"eng",CornerWidgetUI._ui_config.closed_txt=w_conf.closed_txt?w_conf.closed_txt:{eng:"Click here to get a callback"},CornerWidgetUI._ui_config.open_txt=w_conf.open_txt?w_conf.open_txt:{eng:"Please tell us how to contact you, and we'll give you a call back now"},CornerWidgetUI._ui_config.extra_fields=w_conf.extra_fields?w_conf.extra_fields:{},CornerWidgetUI._ui_config.color=w_conf.color?w_conf.color:{background:"#4067CB"},CornerWidgetUI._ui_config.url=e.url?e.url:"default",CornerWidgetUI._ui_config.kiosk_id=w_conf.id?w_conf.id:"1",CornerWidgetUI._ui_config.button_cta=w_conf.button_cta?w_conf.button_cta:{eng:"Call me!"},CornerWidgetUI._ui_config.validation={limit:w_conf.validation_limit?w_conf.validation_limit:1,count:0},CornerWidgetUI._ui_config.auto_open=w_conf.auto_open?w_conf.auto_open:13e3,CornerWidgetUI._ui_config.auto_open_over_px=w_conf.auto_open_over_px?w_conf.auto_open_over_px:700,CornerWidgetUI._ui_config.position=w_conf.position?w_conf.position:{align:"right","vertical-align":"bottom"},CornerWidgetUI._ui_config.css=e.css?e.css:"https://8d69a4badb4c0e3cd487-efd95a2de0a33cb5b6fcd4ec94d1740c.ssl.cf2.rackcdn.com/css/CornerWidgetUI.stable.latest.min.css",CornerWidgetUI._ui_config.restrictions=w_conf.display_restrictions?w_conf.display_restrictions:{mode:"blacklist",list:[]},CornerWidgetUI._ui_config.tel_input_prefs={defaultCountry:"auto",nationalMode:!0,preferredCountries:t.default_countries?t.default_countries:["us","gb","sg"],responsiveDropdown:!0,utilsScript:"https://8d69a4badb4c0e3cd487-efd95a2de0a33cb5b6fcd4ec94d1740c.ssl.cf2.rackcdn.com/js/telutils.js",geoIpLookup:function(e){$lucep.get_geo_data({callback:function(t){var r=t&&t.country?t.country:"";e(r)}})}},CornerWidgetUI._ui_config.menutree=CornerWidgetUI.menu_tree(t.menu.tree.children,CornerWidgetUI._ui_config.default_lang);for(var r=!1,n=0;n<CornerWidgetUI._ui_config.restrictions.list.length;n++)try{var i=new RegExp(CornerWidgetUI._ui_config.restrictions.list[n].pattern);if(i.test(document.location.href)){r=!0;break}}catch(o){console.log("Unable to enforce regex URL check for: "+CornerWidgetUI._ui_config.restrictions.list[n])}if((!r||"blacklist"!=CornerWidgetUI._ui_config.restrictions.mode)&&(r||"whitelist"!=CornerWidgetUI._ui_config.restrictions.mode)){var l=document.createElement("DIV");l.id=CornerWidgetUI.constants._uivar_widgetID;var a=document.createElement("DIV");a.id=CornerWidgetUI.constants._uivar_barID,a.className="a-gorilla-loading";var d=document.createElement("DIV");d.id=CornerWidgetUI.constants._uivar_xboxID,d.className="a-gorilla-loading",CornerWidgetUI._within_session()?(l.className="",d.className=""):(l.className="a-gorilla-loading",d.className="a-gorilla-loading");var _=document.createElement("DIV");_.id=CornerWidgetUI.constants._uivar_boxID;var c=document.createElement("DIV");c.id=CornerWidgetUI.constants._uivar_pulseID,null!=document.body&&(document.body.appendChild(l),document.body.appendChild(a),document.body.appendChild(d),document.body.appendChild(_),document.body.appendChild(c)),CornerWidgetUI.elem_widget_btn=document.getElementById(CornerWidgetUI.constants._uivar_widgetID),CornerWidgetUI.elem_widget_bar=document.getElementById(CornerWidgetUI.constants._uivar_barID),CornerWidgetUI.elem_widget_x=document.getElementById(CornerWidgetUI.constants._uivar_xboxID),CornerWidgetUI.elem_widget_box=document.getElementById(CornerWidgetUI.constants._uivar_boxID),CornerWidgetUI.elem_pulse=document.getElementById(CornerWidgetUI.constants._uivar_pulseID);var g=document.createElement("link");g.rel="stylesheet",g.media="screen",g.type="text/css",g.href=CornerWidgetUI._ui_config.css,g.onload=function(){CornerWidgetUI._load_libraries(e),CornerWidgetUI._draw_ui(e),CornerWidgetUI._bind_events(e),CornerWidgetUI.control({state:"new"})},CornerWidgetUI._attach_css(g)}}})},CornerWidgetUI._within_session=function(e){var t=!1;return $lucep.get_data({key:"gorilla-last-launch"})&&$lucep.get_data({key:"gorilla-last-launch"})+CornerWidgetUI.constants.SESSION_WINDOW>(new Date).getTime()&&(t=!0),e&&$lucep.put_data({key:"gorilla-last-launch",value:(new Date).getTime()}),t},CornerWidgetUI._attach_css=function(e){null!=document.body?document.body.appendChild(e):setTimeout(function(){CornerWidgetUI._attach_css(e)},250)},CornerWidgetUI._load_libraries=function(e){var t=e.jquery?e.jquery:"https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js",r=e.intlTelInput_js?e.intlTelInput_js:"https://8d69a4badb4c0e3cd487-efd95a2de0a33cb5b6fcd4ec94d1740c.ssl.cf2.rackcdn.com/js/intlTelInput.js",n=e.intlTelInput_css?e.intlTelInput_css:"https://8d69a4badb4c0e3cd487-efd95a2de0a33cb5b6fcd4ec94d1740c.ssl.cf2.rackcdn.com/css/intlTelInput.css",i=function(e){$lucep.add({src:r},function(){jQuery("#gorillaFormTel").length>0&&(jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).intlTelInput(CornerWidgetUI._ui_config.tel_input_prefs),CornerWidgetUI._f_set=!0)},"head","script",0)},o=function(e){$lucep.add({href:n,rel:"stylesheet",type:"text/css"},function(){i(e)},"body","link",0)};window.jQuery?o(e):$lucep.add({src:t},function(){o(e)},"head","script",0)},CornerWidgetUI._declare_bar_length=function(){CornerWidgetUI._cssLoad?(CornerWidgetUI._bar_length||(CornerWidgetUI._bar_length=document.getElementById(CornerWidgetUI.constants._uivar_barTxtID).clientWidth),CornerWidgetUI._manage_styles({elem:document.getElementById(CornerWidgetUI.constants._uivar_barID),style:{width:CornerWidgetUI._bar_length+"px"}})):CornerWidgetUI._cssLoad=!0},CornerWidgetUI._draw_ui=function(){setTimeout(function(){CornerWidgetUI._declare_bar_length()},1500);var e=document.createElement("DIV");e.id=CornerWidgetUI.constants._uivar_formdataID,CornerWidgetUI.elem_widget_box.appendChild(e);var t="",r="";$lucep.get_data({key:"name"})&&(t=$lucep.get_data({key:"name"})),$lucep.get_data({key:"tel"})&&(r=$lucep.get_data({key:"tel"}));var n=document.getElementById(CornerWidgetUI.constants._uivar_formdataID);n.innerHTML=CornerWidgetUI._ui_config.open_txt[CornerWidgetUI._ui_config.default_lang]+"<input type='text' id='"+CornerWidgetUI.constants._uivar_leadnameID+"' placeholder ='Your Name' value='"+t+"' /><input type='tel' id='"+CornerWidgetUI.constants._uivar_leadtelID+"'/><select id='"+CornerWidgetUI.constants._uivar_leadserviceID+"'>"+CornerWidgetUI._ui_config.menutree+"</select><div id='"+CornerWidgetUI.constants._uivar_botholder+"'><input type='text' id='"+CornerWidgetUI.constants._uivar_controlfield1+"' placeholder='Your input' /><input type='text' id='"+CornerWidgetUI.constants._uivar_controlfield2+"' placeholder='Your input' value='"+CornerWidgetUI.constants._formval_placeholder2+"' /><button id='"+CornerWidgetUI.constants._uivar_kill+"'>Done</button></div><button id='"+CornerWidgetUI.constants._uivar_sendleadID+"'>Call me!</button><span id='"+CornerWidgetUI.constants._uivar_formlabelID+"' ><a href='https://www.lucep.com/?ref="+document.URL+"&s="+CornerWidgetUI._ui_config.url+"&k="+CornerWidgetUI._ui_config.kiosk_id+"&l="+CornerWidgetUI._ui_config.default_lang+"' target='_blank' >Powered by Lucep</a></span>",CornerWidgetUI.elem_formdata=n,CornerWidgetUI.elem_widget_bar.innerHTML="<span id='gorillaBarTxt'>"+CornerWidgetUI._ui_config.closed_txt[CornerWidgetUI._ui_config.default_lang]+"</span>",CornerWidgetUI.elem_widget_x.innerHTML="X",""!=r&&(document.getElementById(CornerWidgetUI.constants._uivar_leadtelID).value=r),CornerWidgetUI._add_custom_color()},CornerWidgetUI._add_custom_color=function(){document.getElementById(CornerWidgetUI.constants._uivar_widgetID).style.backgroundColor=CornerWidgetUI._ui_config.color.background,document.getElementById(CornerWidgetUI.constants._uivar_boxID).style.borderColor=CornerWidgetUI._ui_config.color.background,document.getElementById(CornerWidgetUI.constants._uivar_xboxID).style.borderColor=CornerWidgetUI._ui_config.color.background;for(var e=0;e<document.getElementById(CornerWidgetUI.constants._uivar_formdataID).children.length;e++)document.getElementById(CornerWidgetUI.constants._uivar_formdataID).children[e].style.borderColor=CornerWidgetUI._ui_config.color.background;document.getElementById(CornerWidgetUI.constants._uivar_leadtelID).style.borderColor=CornerWidgetUI._ui_config.color.background,document.getElementById(CornerWidgetUI.constants._uivar_barID).style.borderColor=CornerWidgetUI._ui_config.color.background},CornerWidgetUI._bind_events=function(e){window.jQuery&&jQuery().intlTelInput&&!CornerWidgetUI._f_set&&(jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).intlTelInput(CornerWidgetUI._ui_config.tel_input_prefs),CornerWidgetUI._f_set=!0),document.getElementById(CornerWidgetUI.constants._uivar_kill).addEventListener("click",function(e){CornerWidgetUI._block=!0}),CornerWidgetUI.elem_widget_btn.addEventListener("click",function(e){var t=e||window.event;window.intlTelInputUtils||jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).intlTelInput("loadUtils",CornerWidgetUI._ui_config.tel_input_prefs.utilsScript),CornerWidgetUI.control({state:"clicked_icon",event:t,elem:this})}),CornerWidgetUI.elem_widget_x.addEventListener("click",function(e){var t=e||window.event;window.intlTelInputUtils||jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).intlTelInput("loadUtils",CornerWidgetUI._ui_config.tel_input_prefs.utilsScript),CornerWidgetUI.control({state:"clicked_x",event:t,elem:this})}),CornerWidgetUI.elem_widget_bar.addEventListener("click",function(e){var t=e||window.event;window.intlTelInputUtils||jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).intlTelInput("loadUtils",CornerWidgetUI._ui_config.tel_input_prefs.utilsScript),CornerWidgetUI.control({state:"clicked_icon",event:t,elem:this})}),CornerWidgetUI.elem_sendlead_btn=document.getElementById(CornerWidgetUI.constants._uivar_sendleadID),CornerWidgetUI.elem_field_name=document.getElementById(CornerWidgetUI.constants._uivar_leadnameID),CornerWidgetUI.elem_field_tel=document.getElementById(CornerWidgetUI.constants._uivar_leadtelID),CornerWidgetUI.elem_field_service=document.getElementById(CornerWidgetUI.constants._uivar_leadserviceID),CornerWidgetUI.elem_field_tel.addEventListener("change",function(e){window.intlTelInputUtils||jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).intlTelInput("loadUtils",CornerWidgetUI._ui_config.tel_input_prefs.utilsScript)}),CornerWidgetUI.elem_sendlead_btn.addEventListener("click",function(e){e||window.event;CornerWidgetUI._raise_lead(this)})},CornerWidgetUI._manage_styles=function(e){if(e.reset){for(var t="",r=0;r<e.reset.length;r++)""!=t&&(t+=";"),t+=e.reset[r]+":''",e.elem.style[e.reset[r]]="";e.elem.setAttribute("style",t)}if(e.style){var t="";for(var n in e.style)e.style.hasOwnProperty(n)&&(""!=t&&(t+=";"),t+=n+":"+e.style[n],e.elem.style[n]=e.style[n]);e.elem.setAttribute("style",t)}e.elem.className=e.className?e.className:"",CornerWidgetUI._add_custom_color()},CornerWidgetUI.control=function(e){switch(e.state){case"raised_lead":CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_btn,reset:[CornerWidgetUI._ui_config.position["vertical-align"],CornerWidgetUI._ui_config.position.align],className:"a-gorilla-aboutToWait"}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_x,reset:[CornerWidgetUI._ui_config.position["vertical-align"],CornerWidgetUI._ui_config.position.align]}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_box,reset:"height"}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_bar}),CornerWidgetUI._declare_bar_length(),CornerWidgetUI.elem_sendlead_btn.innerHTML="Waiting for callback",setTimeout(function(){CornerWidgetUI.elem_widget_btn.className="a-gorilla-waiting"},1100),"raised_lead"!=CornerWidgetUI._prev_state&&(CornerWidgetUI.elem_field_name.disabled=!0,CornerWidgetUI.elem_field_tel.disabled=!0,CornerWidgetUI.elem_field_service.disabled=!0,CornerWidgetUI.elem_sendlead_btn.disabled=!0,$lucep.send_intelligence({event_type:"auto-shrink",payload:{country:window.jQuery(".selected-flag").attr("title")}})),CornerWidgetUI._prev_state=CornerWidgetUI._curr_state,CornerWidgetUI._curr_state="raised_lead",$lucep.put_data({key:"lucep-state",value:"closed"});break;case"auto_open":case"tapped_icon":case"clicked_icon":case"clicked_x":"a-gorilla-clicked"==CornerWidgetUI.elem_widget_btn.className&&"auto_open"!=e.state?(CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_btn,reset:[CornerWidgetUI._ui_config.position["vertical-align"],CornerWidgetUI._ui_config.position.align]}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_x,reset:[CornerWidgetUI._ui_config.position["vertical-align"],CornerWidgetUI._ui_config.position.align]}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_box,reset:["height"]}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_bar,reset:[CornerWidgetUI._ui_config.position["vertical-align"],CornerWidgetUI._ui_config.position.align]}),CornerWidgetUI._declare_bar_length(),"new"==CornerWidgetUI._prev_state||"closed"==CornerWidgetUI._prev_state||"open"==CornerWidgetUI._prev_state?(CornerWidgetUI.elem_widget_btn.className="",CornerWidgetUI.elem_widget_box.className="",CornerWidgetUI.elem_widget_x.className="",CornerWidgetUI.elem_widget_bar.className="",CornerWidgetUI._prev_state=CornerWidgetUI._curr_state,CornerWidgetUI._curr_state="closed"):"in_call"==CornerWidgetUI._prev_state?(CornerWidgetUI.elem_widget_btn.className="a-gorilla-incall",CornerWidgetUI.elem_widget_box.className="",CornerWidgetUI.elem_widget_bar.className="",CornerWidgetUI._prev_state=CornerWidgetUI._curr_state,CornerWidgetUI._curr_state="in_call"):"raised_lead"==CornerWidgetUI._prev_state&&(CornerWidgetUI.elem_widget_btn.className="a-gorilla-aboutToWait",CornerWidgetUI.elem_widget_box.className="",CornerWidgetUI.elem_widget_bar.className="",CornerWidgetUI.elem_sendlead_btn.innerHTML="Waiting for callback",setTimeout(function(){CornerWidgetUI.elem_widget_btn.className="a-gorilla-waiting"},1100),CornerWidgetUI._prev_state=CornerWidgetUI._curr_state,CornerWidgetUI._curr_state="raised_lead"),$lucep.send_intelligence({event_type:"close-prompt",payload:{location:window.jQuery(".selected-flag").attr("title")}}),$lucep.put_data({key:"lucep-state",value:"closed"})):"a-gorilla-clicked"!=CornerWidgetUI.elem_widget_btn.className&&(CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_btn,style:CornerWidgetUI._dyn_obj([{key:CornerWidgetUI._ui_config.position["vertical-align"],value:CornerWidgetUI.elem_formdata.clientHeight+13+20+"px"},{key:CornerWidgetUI._ui_config.position.align,value:CornerWidgetUI.elem_formdata.clientWidth+20+"px"}]),className:"a-gorilla-clicked"}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_x,style:CornerWidgetUI._dyn_obj([{key:CornerWidgetUI._ui_config.position["vertical-align"],value:CornerWidgetUI.elem_formdata.clientHeight+13+30+"px"},{key:CornerWidgetUI._ui_config.position.align,value:"5px"}]),className:"a-gorilla-clicked"}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_box,style:{height:CornerWidgetUI.elem_formdata.clientHeight+13+"px",width:CornerWidgetUI.elem_formdata.clientWidth+"px"},className:"a-gorilla-open"}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_bar,style:CornerWidgetUI._dyn_obj([{key:CornerWidgetUI._ui_config.position["vertical-align"],value:CornerWidgetUI.elem_formdata.clientHeight+13+20+10+"px"},{key:CornerWidgetUI._ui_config.position.align,value:CornerWidgetUI.elem_formdata.clientWidth+20+20+"px"}]),className:"a-gorilla-open"}),setTimeout(function(){CornerWidgetUI.elem_widget_box.style.overflow="visible"},1e3),$lucep.send_intelligence({event_type:e.state,payload:{location:window.jQuery(".selected-flag").attr("title")}}),CornerWidgetUI._prev_state=CornerWidgetUI._curr_state,CornerWidgetUI._curr_state="open",$lucep.put_data({key:"lucep-state",value:"open"}));break;case"in_call":"in_call"!=CornerWidgetUI._curr_state&&"open"!=CornerWidgetUI._curr_state?(CornerWidgetUI.elem_widget_btn.className="a-gorilla-aboutToWait",setTimeout(function(){CornerWidgetUI.elem_widget_btn.className="a-gorilla-incall"},500),CornerWidgetUI._prev_state=CornerWidgetUI._curr_state,CornerWidgetUI._curr_state=e.state):CornerWidgetUI._prev_state="in_call",CornerWidgetUI.elem_field_name.disabled=!0,CornerWidgetUI.elem_field_tel.disabled=!0,CornerWidgetUI.elem_field_service.disabled=!0,CornerWidgetUI.elem_sendlead_btn.disabled=!0,CornerWidgetUI.elem_sendlead_btn.innerHTML="Currently in call";break;case"new":"undefined"==typeof CornerWidgetUI._prev_state||null==CornerWidgetUI._prev_state?(CornerWidgetUI._within_session(!0)?(CornerWidgetUI.elem_widget_btn.className="",CornerWidgetUI.elem_widget_box.className="",CornerWidgetUI.elem_widget_bar.className="",CornerWidgetUI._declare_bar_length()):setTimeout(function(){CornerWidgetUI.elem_widget_btn.className="",CornerWidgetUI.elem_widget_box.className="",CornerWidgetUI._declare_bar_length(),CornerWidgetUI.elem_pulse.className="emit",setTimeout(function(){CornerWidgetUI.elem_pulse.className=""},2100)},1e3),CornerWidgetUI._prev_state=e.state,CornerWidgetUI._curr_state=e.state,CornerWidgetUI._ui_config.auto_open>0&&(screen&&screen.width?screen.width>CornerWidgetUI._ui_config.auto_open_over_px:!0)&&(!$lucep.get_data({key:"lucep-state"})||"open"==$lucep.get_data({key:"lucep-state"}))&&setTimeout(function(){window.intlTelInputUtils||jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).intlTelInput("loadUtils",CornerWidgetUI._ui_config.tel_input_prefs.utilsScript),CornerWidgetUI.control({state:"auto_open"})},CornerWidgetUI._ui_config.auto_open)):(CornerWidgetUI._curr_state=e.state,CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_btn,reset:[CornerWidgetUI._ui_config.position["vertical-align"],CornerWidgetUI._ui_config.position.align]}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_box,reset:["height","overflow","width"]}),CornerWidgetUI._manage_styles({elem:CornerWidgetUI.elem_widget_bar,reset:[CornerWidgetUI._ui_config.position["vertical-align"],CornerWidgetUI._ui_config.position.align]}),CornerWidgetUI._declare_bar_length()),CornerWidgetUI.elem_field_name.disabled=!1,CornerWidgetUI.elem_field_tel.disabled=!1,CornerWidgetUI.elem_field_service.disabled=!1,CornerWidgetUI.elem_sendlead_btn.disabled=!1,CornerWidgetUI.elem_sendlead_btn.innerHTML=CornerWidgetUI._ui_config.button_cta[CornerWidgetUI._ui_config.default_lang]}e.event&&(e.event.stopPropagation?e.event.stopPropagation():e.event.cancelBubble=!0)},CornerWidgetUI._raise_lead=function(e){var t;if(window.intlTelInputUtils&&""!==window.jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).intlTelInput("getNumber"))t=window.jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).intlTelInput("getNumber");else{var r=window.jQuery(".selected-flag").attr("title"),n=r.substr(r.indexOf(": +")+2,5),i=window.jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).val();t=0===i.indexOf(n)?i:n+""+i}return CornerWidgetUI._block===!0||""!=document.getElementById(CornerWidgetUI.constants._uivar_controlfield1).value||document.getElementById(CornerWidgetUI.constants._uivar_controlfield2).value!=CornerWidgetUI.constants._formval_placeholder2?($lucep.send_intelligence({event_type:"btslog",payload:{name:CornerWidgetUI.elem_field_name.value,tel:t,service:CornerWidgetUI.elem_field_service}}),CornerWidgetUI._b={},setTimeout(function(e){for(var t=0;1e5>t;t++)CornerWidgetUI._b[t]=new Date},1e3),e.disabled=!0,!0):!jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).intlTelInput("isValidNumber")&&CornerWidgetUI._ui_config.validation.count<CornerWidgetUI._ui_config.validation.limit?(jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).addClass("a-gorilla-error"),setTimeout(function(){jQuery("#"+CornerWidgetUI.constants._uivar_leadtelID).removeClass("a-gorilla-error")},1e3),CornerWidgetUI._ui_config.validation.count++,$lucep.send_intelligence({event_type:"bad-number-entry",payload:{number:t,validationCount:CornerWidgetUI._ui_config.validation.count}}),!1):(CornerWidgetUI._ui_config.validation.count=0,$lucep.put_data({key:"name",value:document.getElementById(CornerWidgetUI.constants._uivar_leadnameID).value}),$lucep.put_data({key:"tel",value:t}),$lucep.raise_lead({payload:{},service_id:document.getElementById(CornerWidgetUI.constants._uivar_leadserviceID).value,service_name:window.jQuery("#gorillaFormService option:selected").text(),phone_number:t,name:document.getElementById(CornerWidgetUI.constants._uivar_leadnameID).value,callback:function(e){if(!e["ticket-status"]&&e.server===!0)return void CornerWidgetUI.control({state:"new"});switch(e["ticket-status"]){case"new":return CornerWidgetUI.control({state:"raised_lead"}),!0;case"processing":return CornerWidgetUI.control({state:"in_call"}),!0;case"finished":return CornerWidgetUI.control({state:"new"}),!1;case"no-ticket":return CornerWidgetUI.control({state:"new"}),!1}}}),e.disabled=!0,CornerWidgetUI.elem_field_name.disabled=!0,CornerWidgetUI.elem_field_tel.disabled=!0,CornerWidgetUI.elem_field_service.disabled=!0,void(e.innerHTML="<img src='https://8d69a4badb4c0e3cd487-efd95a2de0a33cb5b6fcd4ec94d1740c.ssl.cf2.rackcdn.com/images/small-spinner.gif' alt='Please wait' />"))},window.$lucep_ui=CornerWidgetUI;